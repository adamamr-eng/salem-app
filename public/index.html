<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salem - Ø±Ø¹Ø§ÙŠØ© ÙƒØ¨Ø§Ø± Ø§Ù„Ø³Ù†</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Cairo', 'Tajawal', Arial, sans-serif; 
            background: linear-gradient(135deg, #D4A574 0%, #8B5A3C 100%);
            min-height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            padding: 10px; 
        }
        
        .app-container { 
            width: 100%; 
            max-width: 400px; 
            background: #FFF8F3; 
            border-radius: 25px; 
            box-shadow: 0 20px 60px rgba(139, 90, 60, 0.3), 0 0 80px rgba(212, 165, 116, 0.2); 
            overflow: hidden; 
            height: 700px; 
            display: flex; 
            flex-direction: column;
        }
        .header { 
            background: linear-gradient(135deg, #8B5A3C 0%, #6B4423 100%);
            color: #FFF8F3; 
            padding: 20px 15px; 
            text-align: center;
            position: relative;
        }
        .logo-container {
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #FFF8F3 0%, #F5E6D8 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 20px rgba(139, 90, 60, 0.3);
            border: 3px solid rgba(212, 165, 116, 0.3);
        }

        .logo-text {
            font-size: 38px;
            font-weight: 900;
            background: linear-gradient(135deg, #8B5A3C 0%, #D4A574 50%, #6B4423 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header h1 { 
            font-size: 26px; 
            margin-bottom: 5px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            color: #FFF8F3;
        }
        .header .subtitle { 
            font-size: 13px; 
            opacity: 0.95;
            font-weight: 400;
            color: #D4A574;
        }
        .user-switch { 
            display: flex; 
            justify-content: center; 
            margin-top: 15px; 
            background: rgba(212, 165, 116, 0.2); 
            border-radius: 25px; 
            padding: 3px;
        }
        .user-switch button { 
            padding: 8px 18px; 
            border: none; 
            background: transparent; 
            color: rgba(255, 248, 243, 0.9); 
            cursor: pointer; 
            border-radius: 22px; 
            transition: all 0.3s ease; 
            font-size: 12px;
            font-weight: 600;
        }
        .user-switch button.active { 
            background: #FFF8F3; 
            color: #8B5A3C;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .patient-selector { 
            margin-top: 12px; 
            padding: 8px; 
            background: rgba(212, 165, 116, 0.2); 
            border-radius: 15px;
        }
        .patient-item { 
            background: rgba(255, 248, 243, 0.95); 
            color: #8B5A3C; 
            padding: 10px 14px; 
            border-radius: 12px; 
            margin-bottom: 6px; 
            cursor: pointer; 
            font-size: 13px; 
            font-weight: 600; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            transition: all 0.3s ease;
        }
        .patient-item:hover {
            transform: translateX(-5px);
            box-shadow: 0 3px 10px rgba(139, 90, 60, 0.2);
        }
        .patient-item.active { 
            background: #FFF8F3;
            box-shadow: 0 3px 12px rgba(139, 90, 60, 0.3);
        }
        .add-patient-btn { 
            background: rgba(255, 248, 243, 0.3); 
            color: #FFF8F3; 
            padding: 10px; 
            border-radius: 12px; 
            margin-top: 6px; 
            cursor: pointer; 
            font-size: 12px; 
            text-align: center; 
            border: 2px dashed rgba(255, 248, 243, 0.6);
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .add-patient-btn:hover {
            background: rgba(255, 248, 243, 0.4);
            border-color: #FFF8F3;
        }
        .content { 
            flex: 1; 
            overflow-y: auto; 
            padding: 15px; 
            background: #FFF8F3;
        }
        .content::-webkit-scrollbar { width: 5px; }
        .content::-webkit-scrollbar-thumb { 
            background: linear-gradient(135deg, #D4A574, #8B5A3C); 
            border-radius: 10px; 
        }
        .page { display: none; }
        .page.active { display: block; }
        .card { 
            background: white; 
            border-radius: 16px; 
            padding: 18px; 
            margin-bottom: 14px; 
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.08);
            transition: all 0.3s ease;
        }
        .card:hover {
            box-shadow: 0 6px 20px rgba(139, 90, 60, 0.12);
            transform: translateY(-2px);
        }
        .btn { 
            padding: 12px 20px; 
            border: none; 
            border-radius: 12px; 
            font-size: 14px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(139, 90, 60, 0.2);
        }
        .btn-primary { 
            background: linear-gradient(135deg, #D4A574, #8B5A3C); 
            color: white; 
        }
        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(139, 90, 60, 0.3);
            transform: translateY(-2px);
        }
        .btn-full { width: 100%; }
        .btn-small { 
            padding: 8px 14px; 
            font-size: 12px; 
        }
        .form-group { margin-bottom: 14px; }
        .form-label { 
            display: block; 
            margin-bottom: 6px; 
            color: #6B4423; 
            font-size: 12px; 
            font-weight: 600; 
        }
        .form-input, select.form-input { 
            width: 100%; 
            padding: 10px 12px; 
            border: 2px solid #F5E6D8; 
            border-radius: 10px; 
            font-size: 14px; 
            font-family: inherit;
            background: #FFFAF5;
            transition: all 0.3s ease;
        }
        .form-input:focus, select.form-input:focus { 
            outline: none; 
            border-color: #D4A574;
            background: white;
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.1);
        }
        .medicine-card { 
            background: linear-gradient(135deg, #FFFAF5 0%, white 100%); 
            border-radius: 16px; 
            padding: 18px; 
            margin-bottom: 14px; 
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.1); 
            border-right: 4px solid #D4A574;
            transition: all 0.3s ease;
        }
        .medicine-card:hover {
            transform: translateX(-5px);
            box-shadow: 0 6px 20px rgba(139, 90, 60, 0.15);
        }
        [dir="ltr"] .medicine-card { 
            border-right: none; 
            border-left: 4px solid #D4A574; 
        }
        .medicine-time { 
            font-size: 20px; 
            color: #8B5A3C; 
            font-weight: 700; 
            margin-bottom: 8px; 
        }
        .medicine-name { 
            font-size: 16px; 
            margin-bottom: 5px; 
            color: #6B4423; 
            font-weight: 600; 
        }
        .medicine-dose { 
            color: #A0826B; 
            margin-bottom: 12px; 
            font-size: 13px; 
        }
        
        .activity-card { 
            background: white; 
            border-radius: 16px; 
            padding: 14px; 
            margin-bottom: 12px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.08); 
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .activity-card:hover {
            transform: translateX(-5px);
            box-shadow: 0 6px 20px rgba(139, 90, 60, 0.15);
        }
        .activity-icon { 
            width: 50px; 
            height: 50px; 
            background: linear-gradient(135deg, #D4A574, #8B5A3C); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 24px; 
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(139, 90, 60, 0.2);
        }
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 12px; 
            margin-bottom: 16px; 
        }
        .stat-card { 
            background: white; 
            border-radius: 16px; 
            padding: 16px; 
            text-align: center; 
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.08);
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(139, 90, 60, 0.12);
        }
        .stat-number { 
            font-size: 26px; 
            font-weight: 700; 
            background: linear-gradient(135deg, #D4A574, #8B5A3C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .stat-label { 
            font-size: 11px; 
            color: #A0826B; 
            margin-top: 4px; 
        }
        .alert-card { 
            background: linear-gradient(135deg, #E74C3C, #C0392B); 
            color: white; 
            border-radius: 16px; 
            padding: 14px; 
            margin-bottom: 16px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.2);
        }
        .meal-section { margin-bottom: 16px; }
        .meal-header { 
            background: linear-gradient(135deg, #8B5A3C, #6B4423); 
            color: #FFF8F3; 
            padding: 10px 14px; 
            border-radius: 12px; 
            margin-bottom: 8px; 
            font-weight: 600; 
            font-size: 14px;
            box-shadow: 0 3px 10px rgba(139, 90, 60, 0.2);
        }
        .meal-item { 
            background: white; 
            padding: 12px; 
            border-radius: 12px; 
            margin-bottom: 8px; 
            box-shadow: 0 3px 12px rgba(139, 90, 60, 0.08); 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            transition: all 0.3s ease;
        }
        .meal-item:hover {
            transform: translateX(-3px);
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.12);
        }
        .appointment-card { 
            background: white; 
            border-radius: 16px; 
            padding: 14px; 
            margin-bottom: 12px; 
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.08); 
            border-right: 3px solid #D4A574;
            transition: all 0.3s ease;
        }
        .appointment-card:hover {
            transform: translateX(-5px);
            box-shadow: 0 6px 20px rgba(139, 90, 60, 0.12);
        }
        [dir="ltr"] .appointment-card { 
            border-right: none; 
            border-left: 3px solid #D4A574; 
        }
        .appointment-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 8px; 
        }
        .appointment-date { 
            background: linear-gradient(135deg, #D4A574, #8B5A3C); 
            color: white; 
            padding: 5px 12px; 
            border-radius: 20px; 
            font-size: 11px; 
            font-weight: 600; 
        }
        .vitals-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 12px; 
            margin-bottom: 16px; 
        }
        .vital-input-group { 
            background: white; 
            padding: 14px; 
            border-radius: 12px; 
            box-shadow: 0 3px 12px rgba(139, 90, 60, 0.08);
            transition: all 0.3s ease;
        }
        .vital-input-group:hover {
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.12);
        }
        .vital-input { 
            width: 100%; 
            padding: 8px; 
            border: 2px solid #F5E6D8; 
            border-radius: 8px; 
            font-size: 16px; 
            font-weight: 700; 
            text-align: center; 
            color: #6B4423; 
            background: #FFFAF5;
            transition: all 0.3s ease;
        }
        .vital-input:focus { 
            border-color: #D4A574; 
            outline: none;
            background: white;
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.1);
        }
        .vital-unit { 
            text-align: center; 
            color: #A0826B; 
            font-size: 10px; 
            margin-top: 4px; 
        }
        .history-list { 
            background: white; 
            border-radius: 16px; 
            padding: 14px; 
            margin-top: 16px; 
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.08); 
        }
        .history-item { 
            display: flex; 
            justify-content: space-between; 
            padding: 10px 0; 
            border-bottom: 1px solid #F5E6D8; 
        }
        .history-item:last-child { border-bottom: none; }
        .time-inputs { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 8px; 
            margin-bottom: 14px; 
        }
        .time-slot { 
            padding: 10px; 
            background: #FFFAF5; 
            border-radius: 10px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            font-weight: 600; 
            font-size: 13px; 
            color: #6B4423;
            border: 2px solid transparent;
        }
        .time-slot:hover {
            background: #F5E6D8;
            transform: translateY(-2px);
        }
        .time-slot.selected { 
            background: linear-gradient(135deg, #D4A574, #8B5A3C); 
            color: white;
            box-shadow: 0 4px 12px rgba(139, 90, 60, 0.2);
        }
        .success-message { 
            background: linear-gradient(135deg, #27AE60, #229954); 
            color: white; 
            padding: 12px; 
            border-radius: 12px; 
            margin-bottom: 14px; 
            text-align: center; 
            font-weight: 600; 
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.2);
        }
        .bottom-nav { 
            background: white; 
            padding: 10px 0; 
            display: grid; 
            grid-template-columns: repeat(6, 1fr); 
            border-top: 1px solid #F5E6D8;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.05);
        }
        .nav-item { 
            text-align: center; 
            cursor: pointer; 
            padding: 6px 0;
            transition: all 0.3s ease;
        }
        .nav-item:hover {
            background: #FFFAF5;
        }
        .nav-icon { 
            font-size: 20px; 
            margin-bottom: 3px; 
        }
        .nav-label { 
            font-size: 10px; 
            color: #A0826B; 
            font-weight: 600; 
        }
        .nav-item.active .nav-label { 
            color: #8B5A3C; 
        }
        .nav-item.active .nav-icon {
            filter: drop-shadow(0 2px 4px rgba(139, 90, 60, 0.3));
        }
        .setting-item { 
            background: white; 
            padding: 14px; 
            border-radius: 12px; 
            margin-bottom: 10px; 
            box-shadow: 0 3px 12px rgba(139, 90, 60, 0.08); 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            transition: all 0.3s ease;
        }
        .setting-item:hover {
            box-shadow: 0 4px 15px rgba(139, 90, 60, 0.12);
        }
        .toggle-switch { 
            position: relative; 
            width: 48px; 
            height: 26px; 
        }
        .toggle-switch input { 
            opacity: 0; 
            width: 0; 
            height: 0; 
        }
        .toggle-slider { 
            position: absolute; 
            cursor: pointer; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background-color: #E0D0C0; 
            transition: 0.3s; 
            border-radius: 26px; 
        }
        .toggle-slider:before { 
            position: absolute; 
            content: ""; 
            height: 20px; 
            width: 20px; 
            left: 3px; 
            bottom: 3px; 
            background-color: white; 
            transition: 0.3s; 
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        input:checked + .toggle-slider { 
            background: linear-gradient(135deg, #D4A574, #8B5A3C); 
        }
        input:checked + .toggle-slider:before { 
            transform: translateX(22px); 
        }
        .modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.6); 
            justify-content: center; 
            align-items: center; 
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        .modal.active { display: flex; }
        .modal-content { 
            background: white; 
            border-radius: 20px; 
            padding: 24px; 
            width: 90%; 
            max-width: 350px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        h2, h3 { 
            color: #6B4423; 
            margin-bottom: 12px; 
            font-size: 16px; 
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <div class="logo-container">
                <div class="logo-text">Ø³ÙÙ„ÙŠÙ…</div>
            </div>
            <h1 id="appTitle">Ø³ÙÙ„ÙŠÙ…</h1>
            <p class="subtitle" id="appSubtitle">Ø±Ø¹Ø§ÙŠØ© ÙƒØ¨Ø§Ø± Ø§Ù„Ø³Ù† Ø¨ÙƒÙ„ Ø­Ø¨</p>
            <div class="user-switch">
                <button id="elderBtn" class="active" onclick="switchUserView('elder')">ÙƒØ¨ÙŠØ± Ø§Ù„Ø³Ù†</button>
                <button id="familyBtn" onclick="switchUserView('family')">Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</button>
            </div>
            <div id="patientSelector" class="patient-selector" style="display: none;">
                <div id="patientsList"></div>
                <div class="add-patient-btn" onclick="showAddPatientModal()">+ Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯/Ø¬Ø¯Ø© Ø¬Ø¯ÙŠØ¯</div>
            </div>
        </div>

        <div class="content">
            <div id="homePage-elder" class="page active">
                <div id="elderMedicinesList"></div>
                <h3 id="activitiesTitle">Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
                <div id="activitiesList"></div>
            </div>

            <div id="homePage-family" class="page">
                <div id="familyAlerts"></div>
                <div id="familyStats"></div>
                <div id="familySummary"></div>
            </div>

            <div id="medicinesPage" class="page">
                <div class="card">
                    <h3 id="addMedicineTitle">Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ§Ø¡ Ø¬Ø¯ÙŠØ¯</h3>
                    <div class="form-group">
                        <label class="form-label" id="medNameLabel">Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡</label>
                        <input type="text" class="form-input" id="medName">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="medDoseLabel">Ø§Ù„Ø¬Ø±Ø¹Ø©</label>
                        <input type="text" class="form-input" id="medDose">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="medTimesLabel">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</label>
                        <div class="time-inputs">
                            <div class="time-slot" onclick="toggleTime(this)">8 Øµ</div>
                            <div class="time-slot" onclick="toggleTime(this)">12 Ù…</div>
                            <div class="time-slot" onclick="toggleTime(this)">2 Ù…</div>
                            <div class="time-slot" onclick="toggleTime(this)">6 Ù…</div>
                            <div class="time-slot" onclick="toggleTime(this)">8 Ù…</div>
                            <div class="time-slot" onclick="toggleTime(this)">10 Ù…</div>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-full" onclick="addMedicine()" id="addMedicineBtn">+ Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div id="medicineSuccess" class="success-message" style="display: none;">âœ“ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ§Ø¡ Ø¨Ù†Ø¬Ø§Ø­</div>
                <h3 id="currentMedicinesTitle">Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
                <div id="medicinesList"></div>
            </div>

            <div id="mealsPage" class="page">
                <div class="card">
                    <h3 id="addMealTitle">Ø¥Ø¶Ø§ÙØ© ÙˆØ¬Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                    <div class="form-group">
                        <label class="form-label" id="mealTypeLabel">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¬Ø¨Ø©</label>
                        <select class="form-input" id="mealType">
                            <option>Ø§Ù„Ø¥ÙØ·Ø§Ø±</option>
                            <option>Ø§Ù„ØºØ¯Ø§Ø¡</option>
                            <option>Ø§Ù„Ø¹Ø´Ø§Ø¡</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="mealNameLabel">Ø§Ø³Ù… Ø§Ù„ÙˆØ¬Ø¨Ø©</label>
                        <input type="text" class="form-input" id="mealName">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="mealTimeLabel">Ø§Ù„ÙˆÙ‚Øª</label>
                        <input type="time" class="form-input" id="mealTime">
                    </div>
                    <button class="btn btn-primary btn-full" onclick="addMeal()" id="addMealBtn">+ Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div id="mealSuccess" class="success-message" style="display: none;">âœ“ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¬Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­</div>
                <div id="mealsDisplay"></div>
            </div>

            <div id="appointmentsPage" class="page">
                <div class="card">
                    <h3 id="addAppointmentTitle">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯</h3>
                    <div class="form-group">
                        <label class="form-label" id="doctorNameLabel">Ø§Ø³Ù… Ø§Ù„Ø¯ÙƒØªÙˆØ±</label>
                        <input type="text" class="form-input" id="doctorName">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="clinicNameLabel">Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</label>
                        <input type="text" class="form-input" id="clinicName">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="appointmentDateLabel">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                        <input type="date" class="form-input" id="appointmentDate">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="appointmentTimeLabel">Ø§Ù„ÙˆÙ‚Øª</label>
                        <input type="time" class="form-input" id="appointmentTime">
                    </div>
                    <button class="btn btn-primary btn-full" onclick="addAppointment()" id="addAppointmentBtn">+ Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div id="appointmentSuccess" class="success-message" style="display: none;">âœ“ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù†Ø¬Ø§Ø­</div>
                <h3 id="upcomingAppointmentsTitle">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
                <div id="appointmentsList"></div>
            </div>

            <div id="vitalsPage" class="page">
                <div class="card">
                    <h3 id="recordVitalsTitle">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª</h3>
                    <div class="vitals-grid">
                        <div class="vital-input-group">
                            <label class="form-label" id="systolicLabel">Ø¶ØºØ· Ø¹Ø§Ù„ÙŠ</label>
                            <input type="text" class="vital-input" placeholder="120" id="systolic" inputmode="numeric">
                            <div class="vital-unit">mmHg</div>
                        </div>
                        <div class="vital-input-group">
                            <label class="form-label" id="diastolicLabel">Ø¶ØºØ· Ù…Ù†Ø®ÙØ¶</label>
                            <input type="text" class="vital-input" placeholder="80" id="diastolic" inputmode="numeric">
                            <div class="vital-unit">mmHg</div>
                        </div>
                        <div class="vital-input-group">
                            <label class="form-label" id="glucoseLabel">Ø§Ù„Ø³ÙƒØ±</label>
                            <input type="text" class="vital-input" placeholder="110" id="glucose" inputmode="numeric">
                            <div class="vital-unit">mg/dL</div>
                        </div>
                        <div class="vital-input-group">
                            <label class="form-label" id="heartRateLabel">Ø§Ù„Ù†Ø¨Ø¶</label>
                            <input type="text" class="vital-input" placeholder="72" id="heartRate" inputmode="numeric">
                            <div class="vital-unit">bpm</div>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-full" onclick="saveVitals()" id="saveVitalsBtn">ğŸ’¾ Ø­ÙØ¸</button>
                </div>
                <div id="vitalsSuccess" class="success-message" style="display: none;">âœ“ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø¨Ù†Ø¬Ø§Ø­</div>
                <div class="history-list">
                    <h3 style="font-size: 13px;" id="previousRecordsTitle">Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚</h3>
                    <div id="vitalsHistoryList"></div>
                </div>
            </div>

            <div id="settingsPage" class="page">
                <div class="card">
                    <h3 id="generalSettingsTitle">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
                    <div class="setting-item">
                        <div>
                            <div style="font-weight: 700; font-size: 12px;" id="notificationsTitle">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</div>
                            <div style="font-size: 10px; color: #A0826B;" id="notificationsDesc">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø£Ø¯ÙˆÙŠØ©</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="notificationsToggle" checked onchange="saveSettings()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item" style="cursor: default;">
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 12px; margin-bottom: 6px;" id="languageTitle">Ø§Ù„Ù„ØºØ©</div>
                            <select class="form-input" id="languageSelect" onchange="saveSettings()" style="margin: 0;">
                                <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ğŸ‡ªğŸ‡¬</option>
                                <option value="en">English ğŸ‡ºğŸ‡¸</option>
                                <option value="fr">FranÃ§ais ğŸ‡«ğŸ‡·</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 id="patientInfoTitle">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶</h3>
                    <div class="form-group">
                        <label class="form-label" id="nameLabel">Ø§Ù„Ø§Ø³Ù…</label>
                        <input type="text" class="form-input" id="patientName">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="ageLabel">Ø§Ù„Ø¹Ù…Ø±</label>
                        <input type="text" class="form-input" id="patientAge" inputmode="numeric">
                    </div>
                    <div class="form-group">
                        <label class="form-label" id="phoneLabel">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                        <input type="text" class="form-input" id="patientPhone" inputmode="tel">
                    </div>
                    <button class="btn btn-primary btn-full" onclick="savePatientInfo()" id="saveChangesBtn">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                </div>
                <div class="card">
                    <h3 id="contactsTitle">Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h3>
                    <div id="contactsList"></div>
                    <button class="btn btn-primary btn-full" style="margin-top: 8px;" onclick="showAddContactModal()" id="addContactBtn">+ Ø¥Ø¶Ø§ÙØ©</button>
                </div>
                <div class="card" style="background: #FFF0ED; border: 2px solid #D4A574;">
                    <h3 style="font-size: 13px; color: #8B5A3C;" id="emergencyTitle">âš ï¸ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</h3>
                    <p style="font-size: 11px; color: #6B4423; margin: 6px 0;" id="emergencyDesc">Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡ ÙÙˆØ±ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</p>
                    <button class="btn btn-full" style="background: #E74C3C; color: white; font-weight: 700;" onclick="sendEmergencyAlert()" id="emergencyBtn">ğŸš¨ Ø·ÙˆØ§Ø±Ø¦</button>
                </div>
            </div>
        </div>

        <div class="bottom-nav">
            <div class="nav-item active" onclick="navigateTo('home')">
                <div class="nav-icon">ğŸ </div>
                <div class="nav-label" id="navHome">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            </div>
            <div class="nav-item" onclick="navigateTo('medicines')">
                <div class="nav-icon">ğŸ’Š</div>
                <div class="nav-label" id="navMedicines">Ø§Ù„Ø£Ø¯ÙˆÙŠØ©</div>
            </div>
            <div class="nav-item" onclick="navigateTo('meals')">
                <div class="nav-icon">ğŸ½ï¸</div>
                <div class="nav-label" id="navMeals">Ø§Ù„ÙˆØ¬Ø¨Ø§Øª</div>
            </div>
            <div class="nav-item" onclick="navigateTo('appointments')">
                <div class="nav-icon">ğŸ“…</div>
                <div class="nav-label" id="navAppointments">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</div>
            </div>
            <div class="nav-item" onclick="navigateTo('vitals')">
                <div class="nav-icon">â¤ï¸</div>
                <div class="nav-label" id="navVitals">Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª</div>
            </div>
            <div class="nav-item" onclick="navigateTo('settings')">
                <div class="nav-icon">âš™ï¸</div>
                <div class="nav-label" id="navSettings">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
            </div>
        </div>
    </div>

    <div id="addPatientModal" class="modal">
        <div class="modal-content">
            <h3 id="addPatientModalTitle">Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯/Ø¬Ø¯Ø© Ø¬Ø¯ÙŠØ¯</h3>
            <div class="form-group">
                <label class="form-label" id="newPatientNameLabel">Ø§Ù„Ø§Ø³Ù…</label>
                <input type="text" class="form-input" id="newPatientName">
            </div>
            <div class="form-group">
                <label class="form-label" id="newPatientAgeLabel">Ø§Ù„Ø¹Ù…Ø±</label>
                <input type="number" class="form-input" id="newPatientAge">
            </div>
            <div style="display: flex; gap: 8px;">
                <button class="btn btn-primary" style="flex: 1;" onclick="addNewPatient()" id="addPatientSubmitBtn">Ø¥Ø¶Ø§ÙØ©</button>
                <button class="btn" style="flex: 1; background: #E0D0C0;" onclick="closeAddPatientModal()" id="addPatientCancelBtn">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <div id="addContactModal" class="modal">
        <div class="modal-content">
            <h3 id="addContactModalTitle">Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„</h3>
            <div class="form-group">
                <label class="form-label" id="newContactNameLabel">Ø§Ù„Ø§Ø³Ù…</label>
                <input type="text" class="form-input" id="newContactName">
            </div>
            <div class="form-group">
                <label class="form-label" id="newContactPhoneLabel">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <input type="tel" class="form-input" id="newContactPhone">
            </div>
            <div style="display: flex; gap: 8px;">
                <button class="btn btn-primary" style="flex: 1;" onclick="addNewContact()" id="addContactSubmitBtn">Ø¥Ø¶Ø§ÙØ©</button>
                <button class="btn" style="flex: 1; background: #E0D0C0;" onclick="closeAddContactModal()" id="addContactCancelBtn">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <script>
       // if (!localStorage.getItem('salem_logged_in')) {
//   window.location.href = 'signin.html';
// }



        let currentView = 'elder';
        let currentPage = 'home';
        let currentPatientId = 0;
        let currentLang = 'ar';
        
        const T = {
            ar: {
                appTitle: 'Ø³ÙÙ„ÙŠÙ…', appSubtitle: 'Ø±Ø¹Ø§ÙŠØ© ÙƒØ¨Ø§Ø± Ø§Ù„Ø³Ù† Ø¨ÙƒÙ„ Ø­Ø¨', elder: 'ÙƒØ¨ÙŠØ± Ø§Ù„Ø³Ù†', family: 'Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
                activities: 'Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©', breathing: 'ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„ØªÙ†ÙØ³', memory: 'Ù„Ø¹Ø¨Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©', walking: 'Ø§Ù„Ù…Ø´ÙŠ Ø§Ù„Ø®ÙÙŠÙ',
                minutes: 'Ø¯Ù‚Ø§Ø¦Ù‚', takeMed: 'âœ“ ØªÙ… Ø£Ø®Ø° Ø§Ù„Ø¯ÙˆØ§Ø¡', taken: 'âœ“ ØªÙ… Ø§Ù„Ø£Ø®Ø°', alert: 'ØªÙ†Ø¨ÙŠÙ‡!',
                didntTake: 'Ù„Ù… ÙŠØ£Ø®Ø° Ø¯ÙˆØ§Ø¡ Ø§Ù„Ø¶ØºØ·', compliance: 'Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ø£Ø¯ÙˆÙŠØ©', completedAct: 'Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©',
                lastBP: 'Ø¢Ø®Ø± Ù‚ÙŠØ§Ø³ Ø¶ØºØ·', lastGlucose: 'Ø¢Ø®Ø± Ù‚ÙŠØ§Ø³ Ø³ÙƒØ±', summary: 'Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…', tookMed: 'Ø£Ø®Ø° Ø¯ÙˆØ§Ø¡ Ø§Ù„Ø³ÙƒØ± âœ“',
                home: 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', medicines: 'Ø§Ù„Ø£Ø¯ÙˆÙŠØ©', meals: 'Ø§Ù„ÙˆØ¬Ø¨Ø§Øª', appointments: 'Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯', vitals: 'Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª',
                settings: 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', addMed: 'Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ§Ø¡ Ø¬Ø¯ÙŠØ¯', medName: 'Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡', dose: 'Ø§Ù„Ø¬Ø±Ø¹Ø©', times: 'Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯',
                add: 'Ø¥Ø¶Ø§ÙØ©', currentMeds: 'Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©', delete: 'Ø­Ø°Ù', addMeal: 'Ø¥Ø¶Ø§ÙØ© ÙˆØ¬Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©',
                mealType: 'Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¬Ø¨Ø©', breakfast: 'Ø§Ù„Ø¥ÙØ·Ø§Ø±', lunch: 'Ø§Ù„ØºØ¯Ø§Ø¡', dinner: 'Ø§Ù„Ø¹Ø´Ø§Ø¡', mealName: 'Ø§Ø³Ù… Ø§Ù„ÙˆØ¬Ø¨Ø©',
                time: 'Ø§Ù„ÙˆÙ‚Øª', addAppt: 'Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯', doctor: 'Ø§Ø³Ù… Ø§Ù„Ø¯ÙƒØªÙˆØ±', clinic: 'Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©', date: 'Ø§Ù„ØªØ§Ø±ÙŠØ®',
                upcoming: 'Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©', recordVitals: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª', highBP: 'Ø¶ØºØ· Ø¹Ø§Ù„ÙŠ', lowBP: 'Ø¶ØºØ· Ù…Ù†Ø®ÙØ¶',
                glucose: 'Ø§Ù„Ø³ÙƒØ±', heartRate: 'Ø§Ù„Ù†Ø¨Ø¶', save: 'ğŸ’¾ Ø­ÙØ¸', prevRecords: 'Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚',
                generalSettings: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©', notifications: 'Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª', medAlerts: 'ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø£Ø¯ÙˆÙŠØ©',
                language: 'Ø§Ù„Ù„ØºØ©', patientInfo: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶', name: 'Ø§Ù„Ø§Ø³Ù…', age: 'Ø§Ù„Ø¹Ù…Ø±', phone: 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ',
                saveChanges: 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª', contacts: 'Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„', emergency: 'âš ï¸ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦',
                emergencyDesc: 'Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡ ÙÙˆØ±ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„', emergencyBtn: 'ğŸš¨ Ø·ÙˆØ§Ø±Ø¦', cancel: 'Ø¥Ù„ØºØ§Ø¡',
                addPatient: '+ Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯/Ø¬Ø¯Ø© Ø¬Ø¯ÙŠØ¯', years: 'Ø³Ù†Ø©'
            },
            en: {
                appTitle: 'Salem', appSubtitle: 'Elderly Care with Love', elder: 'Elder', family: 'Family Members',
                activities: 'Daily Activities', breathing: 'Breathing Exercises', memory: 'Memory Game', walking: 'Light Walking',
                minutes: 'minutes', takeMed: 'âœ“ Take Medicine', taken: 'âœ“ Taken', alert: 'Alert!',
                didntTake: 'did not take blood pressure medicine', compliance: 'Medicine Compliance', completedAct: 'Completed Activities',
                lastBP: 'Last BP Reading', lastGlucose: 'Last Glucose', summary: 'Today\'s Summary', tookMed: 'Took diabetes medicine âœ“',
                home: 'Home', medicines: 'Medicines', meals: 'Meals', appointments: 'Appointments', vitals: 'Vitals',
                settings: 'Settings', addMed: 'Add New Medicine', medName: 'Medicine Name', dose: 'Dose', times: 'Times',
                add: 'Add', currentMeds: 'Current Medicines', delete: 'Delete', addMeal: 'Add New Meal',
                mealType: 'Meal Type', breakfast: 'Breakfast', lunch: 'Lunch', dinner: 'Dinner', mealName: 'Meal Name',
                time: 'Time', addAppt: 'Add New Appointment', doctor: 'Doctor Name', clinic: 'Clinic', date: 'Date',
                upcoming: 'Upcoming Appointments', recordVitals: 'Record Vitals', highBP: 'Systolic', lowBP: 'Diastolic',
                glucose: 'Glucose', heartRate: 'Heart Rate', save: 'ğŸ’¾ Save', prevRecords: 'Previous Records',
                generalSettings: 'General Settings', notifications: 'Notifications', medAlerts: 'Medicine Alerts',
                language: 'Language', patientInfo: 'Patient Information', name: 'Name', age: 'Age', phone: 'Phone Number',
                saveChanges: 'ğŸ’¾ Save Changes', contacts: 'Contacts', emergency: 'âš ï¸ Emergency',
                emergencyDesc: 'Send immediate alert to all contacts', emergencyBtn: 'ğŸš¨ Emergency', cancel: 'Cancel',
                addPatient: '+ Add New Grandparent', years: 'years'
            },
            fr: {
                appTitle: 'Salem', appSubtitle: 'Soins aux personnes Ã¢gÃ©es avec amour', elder: 'Personne Ã¢gÃ©e', family: 'Membres de la famille',
                activities: 'ActivitÃ©s quotidiennes', breathing: 'Exercices de respiration', memory: 'Jeu de mÃ©moire', walking: 'Marche lÃ©gÃ¨re',
                minutes: 'minutes', takeMed: 'âœ“ Prendre le mÃ©dicament', taken: 'âœ“ Pris', alert: 'Alerte!',
                didntTake: 'n\'a pas pris le mÃ©dicament pour la tension', compliance: 'ConformitÃ© mÃ©dicamenteuse', completedAct: 'ActivitÃ©s terminÃ©es',
                lastBP: 'DerniÃ¨re TA', lastGlucose: 'DerniÃ¨re glycÃ©mie', summary: 'RÃ©sumÃ© d\'aujourd\'hui', tookMed: 'A pris le mÃ©dicament âœ“',
                home: 'Accueil', medicines: 'MÃ©dicaments', meals: 'Repas', appointments: 'Rendez-vous', vitals: 'Signes vitaux',
                settings: 'ParamÃ¨tres', addMed: 'Ajouter un mÃ©dicament', medName: 'Nom du mÃ©dicament', dose: 'Dose', times: 'Horaires',
                add: 'Ajouter', currentMeds: 'MÃ©dicaments actuels', delete: 'Supprimer', addMeal: 'Ajouter un repas',
                mealType: 'Type de repas', breakfast: 'Petit-dÃ©jeuner', lunch: 'DÃ©jeuner', dinner: 'DÃ®ner', mealName: 'Nom du repas',
                time: 'Heure', addAppt: 'Ajouter un rendez-vous', doctor: 'Nom du mÃ©decin', clinic: 'Clinique', date: 'Date',
                upcoming: 'Rendez-vous Ã  venir', recordVitals: 'Enregistrer les signes', highBP: 'Systolique', lowBP: 'Diastolique',
                glucose: 'Glucose', heartRate: 'FrÃ©quence cardiaque', save: 'ğŸ’¾ Sauvegarder', prevRecords: 'Enregistrements prÃ©cÃ©dents',
                generalSettings: 'ParamÃ¨tres gÃ©nÃ©raux', notifications: 'Notifications', medAlerts: 'Alertes mÃ©dicamenteuses',
                language: 'Langue', patientInfo: 'Informations patient', name: 'Nom', age: 'Ã‚ge', phone: 'NumÃ©ro de tÃ©lÃ©phone',
                saveChanges: 'ğŸ’¾ Sauvegarder', contacts: 'Contacts', emergency: 'âš ï¸ Urgence',
                emergencyDesc: 'Envoyer une alerte Ã  tous les contacts', emergencyBtn: 'ğŸš¨ Urgence', cancel: 'Annuler',
                addPatient: '+ Ajouter un grand-parent', years: 'ans'
            }
        };
        
        let patients = [{
            id: 0, name: 'Ø¬Ø¯ÙŠ Ù…Ø­Ù…Ø¯', age: 72, phone: '01234567890', medicines: [], meals: [], appointments: [],
            vitalsHistory: [], activities: [], contacts: [
                { name: 'Ø§Ù„Ø§Ø¨Ù† - Ø£Ø­Ù…Ø¯', phone: '01111111111' },
                { name: 'Ø§Ù„Ø­ÙÙŠØ¯Ø© - ÙØ§Ø·Ù…Ø©', phone: '01222222222' }
            ], settings: { notifications: true, language: 'ar' }
        }];

        function t(k) { return T[currentLang][k] || k; }
        
        function updateLang(lang) {
            currentLang = lang;
            document.documentElement.setAttribute('lang', lang);
            document.documentElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
            document.getElementById('appTitle').textContent = t('appTitle');
            document.getElementById('appSubtitle').textContent = t('appSubtitle');
            document.getElementById('elderBtn').textContent = t('elder');
            document.getElementById('familyBtn').textContent = t('family');
            document.querySelector('.add-patient-btn').textContent = t('addPatient');
            document.getElementById('activitiesTitle').textContent = t('activities');
            document.getElementById('navHome').textContent = t('home');
            document.getElementById('navMedicines').textContent = t('medicines');
            document.getElementById('navMeals').textContent = t('meals');
            document.getElementById('navAppointments').textContent = t('appointments');
            document.getElementById('navVitals').textContent = t('vitals');
            document.getElementById('navSettings').textContent = t('settings');
            document.getElementById('addMedicineTitle').textContent = t('addMed');
            document.getElementById('medNameLabel').textContent = t('medName');
            document.getElementById('medDoseLabel').textContent = t('dose');
            document.getElementById('medTimesLabel').textContent = t('times');
            document.getElementById('addMedicineBtn').textContent = '+ ' + t('add');
            document.getElementById('currentMedicinesTitle').textContent = t('currentMeds');
            document.getElementById('addMealTitle').textContent = t('addMeal');
            document.getElementById('mealTypeLabel').textContent = t('mealType');
            document.getElementById('mealNameLabel').textContent = t('mealName');
            document.getElementById('mealTimeLabel').textContent = t('time');
            document.getElementById('addMealBtn').textContent = '+ ' + t('add');
            document.getElementById('mealType').innerHTML = `<option>${t('breakfast')}</option><option>${t('lunch')}</option><option>${t('dinner')}</option>`;
            document.getElementById('addAppointmentTitle').textContent = t('addAppt');
            document.getElementById('doctorNameLabel').textContent = t('doctor');
            document.getElementById('clinicNameLabel').textContent = t('clinic');
            document.getElementById('appointmentDateLabel').textContent = t('date');
            document.getElementById('appointmentTimeLabel').textContent = t('time');
            document.getElementById('addAppointmentBtn').textContent = '+ ' + t('add');
            document.getElementById('upcomingAppointmentsTitle').textContent = t('upcoming');
            document.getElementById('recordVitalsTitle').textContent = t('recordVitals');
            document.getElementById('systolicLabel').textContent = t('highBP');
            document.getElementById('diastolicLabel').textContent = t('lowBP');
            document.getElementById('glucoseLabel').textContent = t('glucose');
            document.getElementById('heartRateLabel').textContent = t('heartRate');
            document.getElementById('saveVitalsBtn').textContent = t('save');
            document.getElementById('previousRecordsTitle').textContent = t('prevRecords');
            document.getElementById('generalSettingsTitle').textContent = t('generalSettings');
            document.getElementById('notificationsTitle').textContent = t('notifications');
            document.getElementById('notificationsDesc').textContent = t('medAlerts');
            document.getElementById('languageTitle').textContent = t('language');
            document.getElementById('patientInfoTitle').textContent = t('patientInfo');
            document.getElementById('nameLabel').textContent = t('name');
            document.getElementById('ageLabel').textContent = t('age');
            document.getElementById('phoneLabel').textContent = t('phone');
            document.getElementById('saveChangesBtn').textContent = t('saveChanges');
            document.getElementById('contactsTitle').textContent = t('contacts');
            document.getElementById('addContactBtn').textContent = '+ ' + t('add');
            document.getElementById('emergencyTitle').textContent = t('emergency');
            document.getElementById('emergencyDesc').textContent = t('emergencyDesc');
            document.getElementById('emergencyBtn').textContent = t('emergencyBtn');
            document.getElementById('addPatientModalTitle').textContent = t('addPatient');
            document.getElementById('newPatientNameLabel').textContent = t('name');
            document.getElementById('newPatientAgeLabel').textContent = t('age');
            document.getElementById('addPatientSubmitBtn').textContent = t('add');
            document.getElementById('addPatientCancelBtn').textContent = t('cancel');
            document.getElementById('addContactModalTitle').textContent = t('contacts');
            document.getElementById('newContactNameLabel').textContent = t('name');
            document.getElementById('newContactPhoneLabel').textContent = t('phone');
            document.getElementById('addContactSubmitBtn').textContent = t('add');
            document.getElementById('addContactCancelBtn').textContent = t('cancel');
            
            if (currentView === 'elder') displayElderMedicines();
            if (currentView === 'family') displayFamilyView();
            if (currentPage === 'medicines') displayMedicines();
            if (currentPage === 'meals') displayMeals();
            if (currentPage === 'appointments') displayAppointments();
            if (currentPage === 'vitals') displayVitalsHistory();
        }

        function getCurrentPatient() { return patients.find(p => p.id === currentPatientId) || patients[0]; }

        function switchUserView(view) {
            currentView = view;
            document.getElementById('elderBtn').classList.toggle('active', view === 'elder');
            document.getElementById('familyBtn').classList.toggle('active', view === 'family');
            document.getElementById('patientSelector').style.display = view === 'family' ? 'block' : 'none';
            if (view === 'family') displayPatientsList();
            document.getElementById('homePage-elder').classList.toggle('active', view === 'elder');
            document.getElementById('homePage-family').classList.toggle('active', view === 'family');
            view === 'family' ? displayFamilyView() : displayElderMedicines();
        }

        function displayPatientsList() {
            const list = document.getElementById('patientsList');
            list.innerHTML = '';
            patients.forEach(patient => {
                const item = document.createElement('div');
                item.className = 'patient-item' + (patient.id === currentPatientId ? ' active' : '');
                item.innerHTML = `<span>${patient.name} (${patient.age} ${t('years')})</span><span>ğŸ‘¤</span>`;
                item.onclick = () => selectPatient(patient.id);
                list.appendChild(item);
            });
        }

        function selectPatient(id) {
            currentPatientId = id;
            const patient = getCurrentPatient();
            currentLang = patient.settings.language;
            document.getElementById('languageSelect').value = currentLang;
            updateLang(currentLang);
            displayPatientsList();
            displayFamilyView();
            loadPatientSettings();
        }

        function loadPatientSettings() {
            const patient = getCurrentPatient();
            document.getElementById('patientName').value = patient.name;
            document.getElementById('patientAge').value = patient.age;
            document.getElementById('patientPhone').value = patient.phone;
            document.getElementById('notificationsToggle').checked = patient.settings.notifications;
            document.getElementById('languageSelect').value = patient.settings.language;
        }

        function displayFamilyView() {
            const patient = getCurrentPatient();
            document.getElementById('familyAlerts').innerHTML = `
                <div class="alert-card"><div><strong style="font-size: 13px;">${t('alert')}</strong><br>
                <span style="font-size: 12px;">${patient.name} ${t('didntTake')}</span></div><div style="font-size: 22px;">âš ï¸</div></div>`;
            const activitiesDone = patient.activities.filter(a => a.done).length;
            document.getElementById('familyStats').innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-number">85%</div><div class="stat-label">${t('compliance')}</div></div>
                    <div class="stat-card"><div class="stat-number">${activitiesDone}/3</div><div class="stat-label">${t('completedAct')}</div></div>
                    <div class="stat-card"><div class="stat-number">${patient.vitalsHistory.length > 0 ? patient.vitalsHistory[0].systolic + '/' + patient.vitalsHistory[0].diastolic : '120/80'}</div><div class="stat-label">${t('lastBP')}</div></div>
                    <div class="stat-card"><div class="stat-number">${patient.vitalsHistory.length > 0 ? patient.vitalsHistory[0].glucose : '110'}</div><div class="stat-label">${t('lastGlucose')}</div></div>
                </div>`;
            document.getElementById('familySummary').innerHTML = `
                <div class="card"><h3>${t('summary')} - ${patient.name}</h3>
                <div style="padding: 8px; border-${currentLang === 'ar' ? 'right' : 'left'}: 3px solid #27AE60; margin: 8px 0; background: #E8F8F5; border-radius: 6px;">
                    <div style="font-size: 10px; color: #6B4423;">7:00 ${currentLang === 'ar' ? 'Øµ' : 'AM'}</div>
                    <div style="font-size: 12px; font-weight: 600; color: #27AE60;">${t('tookMed')}</div></div>
                ${patient.activities.map(a => `<div style="padding: 8px; border-${currentLang === 'ar' ? 'right' : 'left'}: 3px solid ${a.done ? '#27AE60' : '#F39C12'}; margin: 8px 0; background: ${a.done ? '#E8F8F5' : '#FEF9E7'}; border-radius: 6px;">
                    <div style="font-size: 10px; color: #6B4423;">${a.time}</div><div style="font-size: 12px; font-weight: 600; color: ${a.done ? '#27AE60' : '#F39C12'};">${a.name} ${a.done ? 'âœ“' : 'â³'}</div></div>`).join('')}
                </div>`;
        }

        function displayElderMedicines() {
            const patient = getCurrentPatient();
            const html = patient.medicines.slice(0, 2).map(med => `
                <div class="medicine-card"><div class="medicine-time">â° ${med.times[0]}</div>
                <div class="medicine-name">ğŸ’Š ${med.name}</div><div class="medicine-dose">${med.dose}</div>
                <button class="btn btn-primary btn-full" onclick="takeMedicine(this)">${t('takeMed')}</button></div>`).join('');
            document.getElementById('elderMedicinesList').innerHTML = html;
            document.getElementById('activitiesList').innerHTML = `
                <div class="activity-card" onclick="markActivityDone('breathing')"><div>
                    <div style="font-weight: 600; font-size: 13px;">${t('breathing')}</div>
                    <div style="font-size: 11px; color: #A0826B;">5 ${t('minutes')}</div></div><div class="activity-icon">ğŸ«</div></div>
                <div class="activity-card" onclick="markActivityDone('memory')"><div>
                    <div style="font-weight: 600; font-size: 13px;">${t('memory')}</div>
                    <div style="font-size: 11px; color: #A0826B;">10 ${t('minutes')}</div></div><div class="activity-icon">ğŸ§ </div></div>
                <div class="activity-card" onclick="markActivityDone('walking')"><div>
                    <div style="font-weight: 600; font-size: 13px;">${t('walking')}</div>
                    <div style="font-size: 11px; color: #A0826B;">15 ${t('minutes')}</div></div><div class="activity-icon">ğŸš¶</div></div>`;
        }

        function navigateTo(page) {
            currentPage = page;
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            if (page === 'home') {
                if (currentView === 'elder') { document.getElementById('homePage-elder').classList.add('active'); displayElderMedicines(); }
                else { document.getElementById('homePage-family').classList.add('active'); displayFamilyView(); }
            } else if (page === 'medicines') { document.getElementById('medicinesPage').classList.add('active'); displayMedicines(); }
            else if (page === 'meals') { document.getElementById('mealsPage').classList.add('active'); displayMeals(); }
            else if (page === 'appointments') { document.getElementById('appointmentsPage').classList.add('active'); displayAppointments(); }
            else if (page === 'vitals') { document.getElementById('vitalsPage').classList.add('active'); displayVitalsHistory(); }
            else if (page === 'settings') { document.getElementById('settingsPage').classList.add('active'); loadPatientSettings(); displayContacts(); }
            document.querySelectorAll('.nav-item').forEach(item => { if (item.onclick.toString().includes(page)) item.classList.add('active'); });
        }

        function takeMedicine(btn) { btn.style.background = '#27AE60'; btn.textContent = t('taken'); btn.disabled = true; }

        function markActivityDone(type) {
            const patient = getCurrentPatient();
            patient.activities.push({ type: type, name: t(type), time: new Date().toLocaleTimeString(currentLang === 'ar' ? 'ar-EG' : currentLang === 'fr' ? 'fr-FR' : 'en-US', { hour: '2-digit', minute: '2-digit' }), done: true });
            alert(currentLang === 'ar' ? 'âœ“ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø· Ø¨Ù†Ø¬Ø§Ø­!' : currentLang === 'fr' ? 'âœ“ ActivitÃ© enregistrÃ©e!' : 'âœ“ Activity recorded!');
        }

        function toggleTime(el) { el.classList.toggle('selected'); }

        function addMedicine() {
            const patient = getCurrentPatient();
            const name = document.getElementById('medName').value;
            const dose = document.getElementById('medDose').value;
            const times = [];
            document.querySelectorAll('.time-slot.selected').forEach(slot => times.push(slot.textContent));
            if (name && dose && times.length > 0) {
                patient.medicines.push({ name, dose, times });
                document.getElementById('medicineSuccess').style.display = 'block';
                setTimeout(() => document.getElementById('medicineSuccess').style.display = 'none', 3000);
                document.getElementById('medName').value = '';
                document.getElementById('medDose').value = '';
                document.querySelectorAll('.time-slot').forEach(t => t.classList.remove('selected'));
                displayMedicines();
                displayElderMedicines();
            } else alert(currentLang === 'ar' ? 'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡ ÙˆØ§Ù„Ø¬Ø±Ø¹Ø© ÙˆØ§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯' : currentLang === 'fr' ? 'Veuillez entrer le mÃ©dicament' : 'Please enter medicine details');
        }

        function displayMedicines() {
            const patient = getCurrentPatient();
            document.getElementById('medicinesList').innerHTML = patient.medicines.map((med, i) => `
                <div class="medicine-card"><div style="display: flex; justify-content: space-between; align-items: center;">
                <div><div class="medicine-name">ğŸ’Š ${med.name}</div><div class="medicine-dose">${med.dose} - ${med.times.join(', ')}</div></div>
                <button class="btn btn-small" style="background: #E74C3C; color: white;" onclick="deleteMedicine(${i})">${t('delete')}</button></div></div>`).join('');
        }

        function deleteMedicine(i) {
            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ§Ø¡ØŸ' : currentLang === 'fr' ? 'Supprimer?' : 'Delete medicine?')) {
                getCurrentPatient().medicines.splice(i, 1);
                displayMedicines();
                displayElderMedicines();
            }
        }

        function addMeal() {
            const patient = getCurrentPatient();
            const type = document.getElementById('mealType').value;
            const name = document.getElementById('mealName').value;
            const time = document.getElementById('mealTime').value;
            if (name && time) {
                patient.meals.push({ type, name, time });
                document.getElementById('mealSuccess').style.display = 'block';
                setTimeout(() => document.getElementById('mealSuccess').style.display = 'none', 3000);
                document.getElementById('mealName').value = '';
                document.getElementById('mealTime').value = '';
                displayMeals();
            } else alert(currentLang === 'ar' ? 'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙˆØ¬Ø¨Ø© ÙˆØ§Ù„ÙˆÙ‚Øª' : currentLang === 'fr' ? 'Entrez les dÃ©tails' : 'Enter meal details');
        }

        function displayMeals() {
            const patient = getCurrentPatient();
            const mealTypes = { [t('breakfast')]: { icon: 'ğŸŒ…', emoji: 'ğŸ¥›' }, [t('lunch')]: { icon: 'â˜€ï¸', emoji: 'ğŸ—' }, [t('dinner')]: { icon: 'ğŸŒ†', emoji: 'ğŸ²' } };
            let html = '';
            Object.keys(mealTypes).forEach(type => {
                const meals = patient.meals.filter(m => m.type === type);
                if (meals.length > 0) html += `<div class="meal-section"><div class="meal-header">${mealTypes[type].icon} ${type}</div>
                    ${meals.map(meal => `<div class="meal-item"><div><div style="font-size: 12px; font-weight: 600;">${meal.name}</div>
                    <div style="font-size: 10px; color: #A0826B;">${meal.time}</div></div><span>${mealTypes[type].emoji}</span></div>`).join('')}</div>`;
            });
            document.getElementById('mealsDisplay').innerHTML = html;
        }

        function addAppointment() {
            const patient = getCurrentPatient();
            const doctor = document.getElementById('doctorName').value;
            const clinic = document.getElementById('clinicName').value;
            const date = document.getElementById('appointmentDate').value;
            const time = document.getElementById('appointmentTime').value;
            if (doctor && clinic && date && time) {
                patient.appointments.push({ doctor, clinic, date, time });
                document.getElementById('appointmentSuccess').style.display = 'block';
                setTimeout(() => document.getElementById('appointmentSuccess').style.display = 'none', 3000);
                document.getElementById('doctorName').value = '';
                document.getElementById('clinicName').value = '';
                document.getElementById('appointmentDate').value = '';
                document.getElementById('appointmentTime').value = '';
                displayAppointments();
            } else alert(currentLang === 'ar' ? 'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª' : currentLang === 'fr' ? 'Remplissez tout' : 'Complete all fields');
        }

        function displayAppointments() {
            const patient = getCurrentPatient();
            document.getElementById('appointmentsList').innerHTML = patient.appointments.map(apt => {
                const dateStr = new Date(apt.date).toLocaleDateString(currentLang === 'ar' ? 'ar-EG' : currentLang === 'fr' ? 'fr-FR' : 'en-US', { day: 'numeric', month: 'long' });
                return `<div class="appointment-card"><div class="appointment-header">
                    <div style="font-weight: 700; font-size: 13px;">${apt.doctor}</div>
                    <div class="appointment-date">${dateStr}</div></div>
                    <div style="font-size: 11px; color: #A0826B;">${apt.clinic}</div>
                    <div style="color: #D4A574; font-weight: 600; font-size: 12px; margin-top: 3px;">â° ${apt.time}</div></div>`;
            }).join('');
        }

        function saveVitals() {
            const patient = getCurrentPatient();
            const systolic = document.getElementById('systolic').value;
            const diastolic = document.getElementById('diastolic').value;
            const glucose = document.getElementById('glucose').value;
            const heartRate = document.getElementById('heartRate').value;
            if (systolic && diastolic && glucose && heartRate) {
                const dateStr = new Date().toLocaleDateString(currentLang === 'ar' ? 'ar-EG' : currentLang === 'fr' ? 'fr-FR' : 'en-US', { day: 'numeric', month: 'long' });
                patient.vitalsHistory.unshift({ systolic, diastolic, glucose, heartRate, date: dateStr });
                document.getElementById('vitalsSuccess').style.display = 'block';
                setTimeout(() => document.getElementById('vitalsSuccess').style.display = 'none', 3000);
                document.getElementById('systolic').value = '';
                document.getElementById('diastolic').value = '';
                document.getElementById('glucose').value = '';
                document.getElementById('heartRate').value = '';
                displayVitalsHistory();
            } else alert(currentLang === 'ar' ? 'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª' : currentLang === 'fr' ? 'Entrez tout' : 'Enter all vitals');
        }

        function displayVitalsHistory() {
            const patient = getCurrentPatient();
            const bpLabel = currentLang === 'ar' ? 'Ø¶ØºØ·' : currentLang === 'fr' ? 'TA' : 'BP';
            document.getElementById('vitalsHistoryList').innerHTML = patient.vitalsHistory.slice(0, 5).map(vital => `
                <div class="history-item"><div><div style="font-weight: 700; font-size: 13px;">${vital.systolic}/${vital.diastolic}</div>
                <div style="font-size: 9px; color: #A0826B;">${bpLabel}</div></div>
                <div style="text-align: ${currentLang === 'ar' ? 'left' : 'right'};"><div style="font-weight: 700; color: #D4A574; font-size: 13px;">${vital.glucose}</div>
                <div style="font-size: 9px; color: #A0826B;">${vital.date}</div></div></div>`).join('');
        }

        function saveSettings() {
            const patient = getCurrentPatient();
            patient.settings.notifications = document.getElementById('notificationsToggle').checked;
            const newLang = document.getElementById('languageSelect').value;
            patient.settings.language = newLang;
            updateLang(newLang);
            alert(currentLang === 'ar' ? 'âœ“ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' : currentLang === 'fr' ? 'âœ“ ParamÃ¨tres sauvegardÃ©s' : 'âœ“ Settings saved');
        }

        function savePatientInfo() {
            const patient = getCurrentPatient();
            patient.name = document.getElementById('patientName').value;
            patient.age = document.getElementById('patientAge').value;
            patient.phone = document.getElementById('patientPhone').value;
            displayPatientsList();
            alert(currentLang === 'ar' ? 'âœ“ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª' : currentLang === 'fr' ? 'âœ“ Informations sauvegardÃ©es' : 'âœ“ Information saved');
        }

        function displayContacts() {
            const patient = getCurrentPatient();
            document.getElementById('contactsList').innerHTML = patient.contacts.map((contact, i) => `
                <div class="setting-item"><div><div style="font-weight: 700; font-size: 12px;">${contact.name}</div>
                <div style="font-size: 10px; color: #A0826B;">${contact.phone}</div></div>
                <div style="cursor: pointer;" onclick="deleteContact(${i})">ğŸ—‘ï¸</div></div>`).join('');
        }

        function deleteContact(i) {
            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ØŸ' : currentLang === 'fr' ? 'Supprimer?' : 'Delete contact?')) {
                getCurrentPatient().contacts.splice(i, 1);
                displayContacts();
            }
        }

        function showAddPatientModal() { document.getElementById('addPatientModal').classList.add('active'); }
        function closeAddPatientModal() { document.getElementById('addPatientModal').classList.remove('active'); }

        function addNewPatient() {
            const name = document.getElementById('newPatientName').value;
            const age = document.getElementById('newPatientAge').value;
            if (name && age) {
                patients.push({ id: patients.length, name, age, phone: '', medicines: [], meals: [], appointments: [], vitalsHistory: [], activities: [], contacts: [], settings: { notifications: true, language: currentLang } });
                document.getElementById('newPatientName').value = '';
                document.getElementById('newPatientAge').value = '';
                closeAddPatientModal();
                displayPatientsList();
                alert(currentLang === 'ar' ? 'âœ“ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±ÙŠØ¶ Ø¨Ù†Ø¬Ø§Ø­' : currentLang === 'fr' ? 'âœ“ Patient ajoutÃ©' : 'âœ“ Patient added');
            } else alert(currentLang === 'ar' ? 'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¹Ù…Ø±' : currentLang === 'fr' ? 'Entrez le nom et l\'Ã¢ge' : 'Enter name and age');
        }

        function showAddContactModal() { document.getElementById('addContactModal').classList.add('active'); }
        function closeAddContactModal() { document.getElementById('addContactModal').classList.remove('active'); }

        function addNewContact() {
            const patient = getCurrentPatient();
            const name = document.getElementById('newContactName').value;
            const phone = document.getElementById('newContactPhone').value;
            if (name && phone) {
                patient.contacts.push({ name, phone });
                document.getElementById('newContactName').value = '';
                document.getElementById('newContactPhone').value = '';
                closeAddContactModal();
                displayContacts();
                alert(currentLang === 'ar' ? 'âœ“ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„' : currentLang === 'fr' ? 'âœ“ Contact ajoutÃ©' : 'âœ“ Contact added');
            } else alert(currentLang === 'ar' ? 'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ' : currentLang === 'fr' ? 'Entrez les dÃ©tails' : 'Enter contact details');
        }

        function sendEmergencyAlert() {
            const patient = getCurrentPatient();
            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡ Ø·ÙˆØ§Ø±Ø¦ Ù„Ø¬Ù…ÙŠØ¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ØŸ' : currentLang === 'fr' ? 'Envoyer une alerte d\'urgence?' : 'Send emergency alert?')) {
                alert(currentLang === 'ar' ? `ğŸš¨ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡ Ø·ÙˆØ§Ø±Ø¦ Ù„Ù€ ${patient.contacts.length} Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„` : currentLang === 'fr' ? `ğŸš¨ Alerte envoyÃ©e Ã  ${patient.contacts.length} contacts` : `ğŸš¨ Alert sent to ${patient.contacts.length} contacts`);
            }
        }
        function handleLogout() {
            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ' : currentLang === 'fr' ? 'DÃ©connexion?' : 'Logout?')) {
                localStorage.removeItem('salem_logged_in');
                localStorage.removeItem('salem_current_user');
                window.location.href = 'signin.html';
            }
        }

        const patient = getCurrentPatient();
        currentLang = patient.settings.language;
        updateLang(currentLang);
        displayElderMedicines();
        // Ø£ÙˆÙ„ Ù…Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠÙØªØ­ØŒ ÙŠÙˆØ¬Ù‘Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  window.onload = function() {
    // ØªØ£ÙƒØ¯ Ø¥Ù† ØµÙØ­Ø© sign-in.html Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ù…Ø¬Ù„Ø¯ public
    window.location.href = "/signin.html";
  }
    </script>
</body>
</html>